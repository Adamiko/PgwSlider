/**
 * PgwSlider - Version 1.1
 *
 * Copyright 2014, Jonathan M. Piat
 * http://pgwjs.com - http://pagawa.com
 * 
 * Released under the MIT license - http://opensource.org/licenses/MIT
 */
(function(a){a.fn.pgwSlider=function(i){var e={autoSlide:true,adaptiveHeight:false,adaptiveDuration:400,transitionDuration:400,intervalDuration:3000};if(this.length==0){return this}else{if(this.length>1){this.each(function(){a(this).pgwSlider(i)});return this}}var g={};g.plugin=this;g.data=[];g.config={};g.psCurrentNb=0;g.nbElements=0;g.eventInterval=null;g.window=a(window);var h=function(){g.config=a.extend({},e,i);c();if(g.config.autoSlide){f()}return true};var b=function(l){var m={};var o=l.find("a").attr("href");if((typeof o!="undefined")&&(o!="")){m.link=o;var r=l.find("a").attr("target");if((typeof r!="undefined")&&(r!="")){m.linkTarget=r}}var k=l.find("img").attr("src");if((typeof k!="undefined")&&(k!="")){m.thumbnail=k}var s=l.find("img").attr("data-large-url");if((typeof s!="undefined")&&(s!="")){m.image=s}var p=l.find("span").text();if((typeof p!="undefined")&&(p!="")){m.title=p}else{var n=l.find("img").attr("data-title");if((typeof n!="undefined")&&(n!="")){m.title=n}}var q=l.find("img").attr("data-description");if((typeof q!="undefined")&&(q!="")){m.description=q}return m};var d=function(k,l){var m=((k-((g.nbElements-1)*6))/g.nbElements);var n=(100/g.nbElements);g.plugin.find("ul li").css({width:n+"%"});if(typeof l!="undefined"&&l){g.plugin.find(".psCurrent").animate({height:k},g.config.adaptiveDuration,function(){g.plugin.find("ul li").animate({height:m},g.config.adaptiveDuration)})}else{g.plugin.find(".psCurrent").css("height",k);g.plugin.find("ul li").css("height",m)}return true};var c=function(){g.plugin.prepend('<div class="psCurrent"></div>');g.nbElements=g.plugin.find("ul li").length;var k=0;g.plugin.find("ul li").each(function(){var l=b(a(this));l.id=k;g.data.push(l);a(this).addClass("elt_"+l.id);if(typeof l.title!="undefined"){if(a(this).find("span").length==1){if(a(this).find("span").text()==""){a(this).find("span").text(l.title)}}else{a(this).find("img").after("<span>"+l.title+"</span>")}}a(this).css("cursor","pointer").click(function(m){m.preventDefault();j(l.id)});k++});if(g.config.autoSlide){g.plugin.on("mouseenter",function(){clearInterval(g.eventInterval);g.eventInterval=null}).on("mouseleave",function(){f()})}j(0,true);return true};var j=function(k,n){g.psCurrentNb=k;var m=g.data[k];var l=g.plugin.find(".psCurrent");l.animate({opacity:0},g.config.transitionDuration,function(){g.plugin.find("ul li").css("opacity","0.6");g.plugin.find("ul li.elt_"+k).css("opacity","1");if(typeof m.image!="undefined"){l.html('<img src="'+m.image+'" alt="'+(m.title?m.title:"")+'">')}else{if(typeof m.thumbnail!="undefined"){l.html('<img src="'+m.thumbnail+'" alt="'+(m.title?m.title:"")+'">')}else{l.html("")}}var o="";if(m.title){o+="<b>"+m.title+"</b>"}if(m.description){if(o!=""){o+="<br>"}o+=m.description}if(o!=""){l.append("<span>"+o+"</span>")}if(m.link){var p="";if(m.linkTarget){var p=' target="'+m.linkTarget+'"'}l.html('<a href="'+m.link+'"'+p+">"+l.html()+"</a>")}l.find("img").load(function(){if(typeof g.plugin.find(".psCurrent").attr("data-checked")=="undefined"){var q=g.plugin.find(".psCurrent img").height();d(q);g.plugin.find(".psCurrent").attr("data-checked","true");g.window.resize(function(){var r=g.plugin.find(".psCurrent img").height();d(r)})}else{if(g.config.adaptiveHeight){var q=g.plugin.find(".psCurrent img").height();d(q,true)}}});l.animate({opacity:1},g.config.transitionDuration)});return true};var f=function(){if(g.nbElements>1&&g.config.autoSlide){g.eventInterval=setInterval(function(){var l=g.nbElements-1;if(g.psCurrentNb+1<=l){var k=g.psCurrentNb+1}else{var k=0}j(k)},g.config.intervalDuration)}return true};h();return this}})(jQuery);
